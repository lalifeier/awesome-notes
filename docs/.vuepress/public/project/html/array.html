<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      var arr = [
        {
          name: 'ZYTX',
          age:
            'Y13xG_4wQnOWK1QwJLgg11d0pS4hewePU95UHtpMl3eE81uS74NC-6zu-Rtnw4Ix',
          gender: 'AAAAAA.doc',
        },
        {
          name: 'ZYTA',
          age:
            'Y13xG_4wQnOWK1QwJLgg11d0pS4hewePU95UHtpMl3eE81uS74NC-6zu-Rtnw4Ix',
          gender: 'BBBBBB.doc',
        },
        {
          name: 'ZDTX',
          age:
            'Y13xG_4wQnOWK1QwJLgg11d0pS4hewePU95UHtpMl3eE81uS74NC-6zu-Rtnw4Ix',
          gender: 'CCCCCC.doc',
        },
        {
          name: 'ZYTX',
          age:
            'Y13xG_4wQnOWK1QwJLgg11d0pS4hewePU95UHtpMl3eE81uS74NC-6zu-Rtnw4Ix',
          gender: 'AAAAAA.doc',
        },
      ]
      let hash = {}
      arr = arr.reduce(function(item, next) {
        hash[next.name] ? '' : (hash[next.name] = true && item.push(next))
        return item
      }, [])
      // console.log(arr)

      // let array = [1, 1, 1, 1, 2, 3, 4, 4, 5, 3]
      // console.log(unique(array))

      // function unique(arr) {
      //   return Array.from(new Set(arr))
      // }
      // function unique(arr) {
      //   return [...new Set(arr)]
      // }

      let arrayList = [
        {
          id: '1',
          name: 'one',
        },
        {
          id: '2',
          name: 'tow',
        },
        {
          id: '3',
          name: 'three',
        },
        {
          id: '1',
          name: 'one',
        },
        {
          id: 2,
          name: 'tow',
        },
        {
          id: '3',
          name: 'three',
        },
        {
          id: '3',
          name: 'three',
        },
      ]
      console.log(unique(arrayList, 'id'))

      function unique(arr, key) {
        let map = new Map()
        arr.forEach(item => {
          if (!map.has(item[key])) {
            map.set(item[key], item)
          }
        })
        return [...map.values()]
      }

      // function unique(arr) {
      //   const map = new Map()
      //   return arr.filter(a => !map.has(a) && map.set(a, 1))
      // }

      // function compare(a, b) {
      //   return parseFloat(a) > parseFloat(b)
      // }
      // function compare(a, b) {
      //   return Number(a.replace('%', '')) > Number(b.replace('%', ''))
      // }
      // console.log(compare('15%', '4.5%'))

      let dataArr = [
        { material_no: '1001', material_name: 'Material 1', qty: 100 },
        { material_no: '1001', material_name: 'Material 1', qty: 50 },
        { material_no: '1002', material_name: 'Material 2', qty: 44 },
        { material_no: '1003', material_name: 'Material 3', qty: 125 },
        { material_no: '1002', material_name: 'Material 2', qty: 59 },
        { material_no: '1004', material_name: 'Material 4', qty: 999 },
        { material_no: '1005', material_name: 'Material 5', qty: 80 },
        { material_no: '1005', material_name: 'Material 5', qty: 66 },
      ]

      // const sums = [
      //   ...data
      //     .reduce((map, item) => {
      //       const { material_no: key, qty } = item
      //       const prev = map.get(key)
      //       if (prev) {
      //         prev.qty += qty
      //       } else {
      //         map.set(key, Object.assign({}, item))
      //       }
      //       return map
      //     }, new Map())
      //     .values(),
      // ]

      // console.log(sums)

      // let result = Object.values(
      //   data.reduce(
      //     (a, c) => (
      //       (a[c.material_no] = a[c.material_no]
      //         ? ((a[c.material_no].qty += c.qty), a[c.material_no])
      //         : c),
      //       a
      //     ),
      //     {}
      //   )
      // )
      // console.log(result)

      console.log(groupByWithSum(dataArr, 'material_no', ['qty']))
      // function groupByWithSum(arr, groupKey, keys) {
      //   return [
      //     ...arr
      //       .reduce((map, item) => {
      //         const key = item[groupKey]
      //         const value = map.get(key)
      //         if (value) {
      //           keys.forEach(key => {
      //             value[key] += item[key]
      //           })
      //         } else {
      //           map.set(key, Object.assign({}, item))
      //         }
      //         return map
      //       }, new Map())
      //       .values(),
      //   ]
      // }

      function groupByWithSum(arr, key, keys) {
        return arr.reduce((total, val) => {
          let index = total.findIndex(obj => obj[key] == val[key])
          if (index === -1) {
            total.push(val)
          } else {
            keys.forEach(key => {
              total[index][key] += val[key]
            })
          }
          return total
        }, [])
      }

      console.log(groupBy(dataArr, 'material_no'))
      function groupBy(arr, key) {
        return arr.reduce((total, val) => {
          const value = val[key]
          total[value] = total[value] || []
          total[value].push(val)
          return total
        }, Object.create(null))
      }

      // Math.round(num * 10000) / 100 + '%'

      let number = 0.00126
      console.log(
        number.toLocaleString('zh', {
          style: 'percent',
          minimumFractionDigits: 2,
          useGrouping: false,
        })
      )
      number = 6666.6666
      console.log(number.toLocaleString())

      console.log(
        number.toLocaleString('zh', { style: 'currency', currency: 'CNY' })
      )

      console.log(formatDate(new Date()))

      console.log(formatDate(new Date(), 'yyyy-MM-dd'))

      console.log(formatDate(new Date(), 'hh:mm:ss'))

      function formatDate(date, fmt = 'yyyy-MM-dd hh:mm:ss') {
        const o = {
          'M+': date.getMonth() + 1,
          'd+': date.getDate(),
          'h+': date.getHours(),
          'm+': date.getMinutes(),
          's+': date.getSeconds(),
          'q+': Math.floor((date.getMonth() + 3) / 3),
          S: date.getMilliseconds(),
        }
        if (/(y+)/.test(fmt))
          fmt = fmt.replace(
            RegExp.$1,
            (date.getFullYear() + '').substr(4 - RegExp.$1.length)
          )
        for (var k in o)
          if (new RegExp('(' + k + ')').test(fmt))
            fmt = fmt.replace(
              RegExp.$1,
              RegExp.$1.length == 1
                ? o[k]
                : ('00' + o[k]).substr(('' + o[k]).length)
            )
        return fmt
      }
    </script>
  </body>
</html>
