{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{385:function(s,a,t){\"use strict\";t.r(a);var n=t(46),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[t(\"h2\",{attrs:{id:\"介绍\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#介绍\"}},[s._v(\"#\")]),s._v(\" 介绍\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"docker\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker\"}},[s._v(\"#\")]),s._v(\" Docker\")]),s._v(\" \"),t(\"h2\",{attrs:{id:\"基本概念\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#基本概念\"}},[s._v(\"#\")]),s._v(\" 基本概念\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"docker-镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-镜像\"}},[s._v(\"#\")]),s._v(\" Docker 镜像\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker 的镜像文件，相当于是一个只读层，不能往里面写入数据。我们可以通过编写 dockerfile 文件，定义需要安装的程序，比如说 MySQL、Redis、JDK、Node.js 等等，然后执行这个 dockerfile 文件，创建出镜像文件。\")]),s._v(\" \"),t(\"p\",[s._v(\"手写 dockerfile 还是比较麻烦的，所以我们可以在 Docker 的镜像仓库里面寻找别人已经创建好的镜像，比如说你想部署 Java 程序，那么就在线下载 Java 镜像即可，非常简单。\")]),s._v(\" \"),t(\"p\",[s._v(\"毕竟 Docker 镜像是只读层，如果我们想要往里面部署层序应该怎么办呢？这个很简单，我们可以给镜像创建一个容器，容器是可读可写的，我们把程序部署在容器里就行了。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"docker-容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-容器\"}},[s._v(\"#\")]),s._v(\" Docker 容器\")]),s._v(\" \"),t(\"p\",[s._v(\"我们说的在 Docker 虚拟机中创建实例，指的就是容器。因为镜像的内容是只读的，想要部署程序，我们需要创建出容器实例，容器的内容是可以读写的，可以用来部署程序。\")]),s._v(\" \"),t(\"p\",[s._v(\"而且容器之间是完全隔离的，我们不用担心一个容器中部署程序，会影响到另一个容器。就比如说我们在 CentOS 上直接安装 MySQL 8.0，它跟 Percona Toolkit 有冲突，跟 Sysbench 也有冲突，所以我们做在线修改表结构，以及做压力测试的时候，都是挑选新的虚拟机实例来安装这些程序，访问 MySQL 的。如果用上了 Docker，我可以在 A 容器里安装 MySQL，在 B 容器跑压力测试，根本不会有冲突。\")]),s._v(\" \"),t(\"p\",[s._v(\"再有，必须先有镜像，才能创建出容器，镜像和容器之间是关联的关系。而且一个镜像可以创建出多个容器，像是 SaaS 云计算，运营商可以把进销存系统打成镜像。有企业购买进销存系统，那么运营商就给客户创建一个容器，客户的进销存数据保存在容器 A 里面。再有客户购买进销存系统，运营商就创建容器 B，以此类推。云计算服务商就是这么卖软件的。\")]),s._v(\" \"),t(\"h2\",{attrs:{id:\"环境安装\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#环境安装\"}},[s._v(\"#\")]),s._v(\" 环境安装\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"安装\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装\"}},[s._v(\"#\")]),s._v(\" 安装\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"卸载旧版本\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum remove docker \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-client \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-client-latest \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-common \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-latest \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-latest-logrotate \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-logrotate \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-selinux \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-engine-selinux \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n                  docker-engine\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"安装必要的一些系统工具\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" -y yum-utils device-mapper-persistent-data lvm2\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"添加软件源信息\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 官方源\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#yum-config-manager \\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    --add-repo \\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    https://download.docker.com/linux/centos/docker-ce.repo\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"更新并安装 Docker-CE\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum makecache fast\\nyum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" docker-ce\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"启动\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"systemctl start docker\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"开机自启\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"systemctl \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"enable\")]),s._v(\" docker\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"建立 docker 用户组\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"groupadd\")]),s._v(\" docker\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"usermod\")]),s._v(\" -aG docker your-user\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"参考\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考\"}},[s._v(\"#\")]),s._v(\" 参考:\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"a\",{attrs:{href:\"https://developer.aliyun.com/mirror/docker-ce\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://developer.aliyun.com/mirror/docker-ce\"),t(\"OutboundLink\")],1)])]),s._v(\" \"),t(\"h3\",{attrs:{id:\"脚本自动安装\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#脚本自动安装\"}},[s._v(\"#\")]),s._v(\" 脚本自动安装\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -sSL https://get.daocloud.io/docker \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sh\")]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -fsSL https://get.docker.com -o get-docker.sh\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sh\")]),s._v(\" get-docker.sh --mirror Aliyun\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"参考-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-2\"}},[s._v(\"#\")]),s._v(\" 参考:\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"a\",{attrs:{href:\"https://get.daocloud.io/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://get.daocloud.io/\"),t(\"OutboundLink\")],1)])]),s._v(\" \"),t(\"h3\",{attrs:{id:\"镜像加速器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#镜像加速器\"}},[s._v(\"#\")]),s._v(\" 镜像加速器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -sSL https://get.daocloud.io/daotools/set_mirror.sh \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sh\")]),s._v(\" -s http://f1361db2.m.daocloud.io\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"参考-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-3\"}},[s._v(\"#\")]),s._v(\" 参考:\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"a\",{attrs:{href:\"https://www.daocloud.io/mirror#accelerator-doc\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://www.daocloud.io/mirror#accelerator-doc\"),t(\"OutboundLink\")],1)])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/docker/daemon.json\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"table\",[t(\"thead\",[t(\"tr\",[t(\"th\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"镜像加速器\")]),s._v(\" \"),t(\"th\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"镜像加速器地址\")]),s._v(\" \"),t(\"th\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"专属加速器\")]),s._v(\" \"),t(\"th\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"其它加速\")])])]),s._v(\" \"),t(\"tbody\",[t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker 中国官方镜像\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://registry.docker-cn.com\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"DaoCloud 镜像站\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"http://f1361db2.m.daocloud.io\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"可登录，系统分配\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Azure 中国镜像\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://dockerhub.azk8s.cn\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub、GCR、Quay\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"科大镜像站\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://docker.mirrors.ustc.edu.cn\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub、GCR、Quay\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"阿里云\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://1nj0zren.mirror.aliyuncs.com\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"需登录，系统分配\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"七牛云\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://reg-mirror.qiniu.com\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub、GCR、Quay\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"网易云\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://hub-mirror.c.163.com\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub\")])]),s._v(\" \"),t(\"tr\",[t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"腾讯云\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"https://mirror.ccs.tencentyun.com\")]),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}}),s._v(\" \"),t(\"td\",{staticStyle:{\"text-align\":\"center\"}},[s._v(\"Docker Hub\")])])])]),s._v(\" \"),t(\"h2\",{attrs:{id:\"使用\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#使用\"}},[s._v(\"#\")]),s._v(\" 使用\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"显示-docker-系统信息\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#显示-docker-系统信息\"}},[s._v(\"#\")]),s._v(\" 显示 Docker 系统信息\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker info\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"镜像管理\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#镜像管理\"}},[s._v(\"#\")]),s._v(\" 镜像管理\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#搜索镜像\")]),s._v(\"\\ndocker search 关键字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#下载镜像\")]),s._v(\"\\ndocker pull 镜像名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看镜像\")]),s._v(\"\\ndocker images\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#重命名镜像\")]),s._v(\"\\ndocker tag 旧镜像 新镜像\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除镜像\")]),s._v(\"\\ndocker rmi 镜像名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#导出镜像\")]),s._v(\"\\ndocker save -o 压缩文件路径 镜像名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#导入镜像\")]),s._v(\"\\ndocker load \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\" 压缩文件路径\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#镜像⼤⼩\")]),s._v(\"\\ndocker system \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"df\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看指定镜像的创建历史\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"history\")]),s._v(\" 镜像名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#迁移镜像 从⼀个机器将镜像迁移到另⼀个机器，并且带进度条\")]),s._v(\"\\ndocker save \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"镜像名\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bzip2\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"pv\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ssh\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"⽤户名\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\"@\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"主机名\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'cat | docker load'\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"创建容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建容器\"}},[s._v(\"#\")]),s._v(\" 创建容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建普通容器\")]),s._v(\"\\ndocker run -it --name 别名 镜像名字 程序名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建含有端口映射的容器\")]),s._v(\"\\ndocker run -it --name 别名 -p 宿主机端口:容器端口 镜像名字 程序名字\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建含有挂载目录的容器\")]),s._v(\"\\ndocker run -it --name 别名 -v 宿主机目录:容器目录 --privileged 镜像名字 程序名字\\n\\n-it 启动容器开启交互界面\\n-p  小写p表示docker会选择一个具体的宿主机端口映射到容器内部开放的网络端口上。\\n-P  大写P表示docker会随机选择一个宿主机端口映射到容器内部开放的网络端口上。\\n--privileged 使用该参数，container内的root拥有真正的root权限。否则，container内的root只是外部的一个普通用户权限\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"操作容器状态\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#操作容器状态\"}},[s._v(\"#\")]),s._v(\" 操作容器状态\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看容器列表\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\" ‐a\\ndocker container \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\" --all\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看容器信息\")]),s._v(\"\\ndocker inspect 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除容器\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#暂停容器\")]),s._v(\"\\ndocker pasue 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#恢复容器\")]),s._v(\"\\ndocker unpause 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#停止容器\")]),s._v(\"\\ndocker stop 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#启动容器\")]),s._v(\"\\ndocker start -i 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看容器日志\")]),s._v(\"\\ndocker logs 容器 -f\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#检查容器里文件结构的更改\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"diff\")]),s._v(\" 容器\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#从容器创建一个新的镜像\")]),s._v(\"\\ndocker commit -a \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"提交人信息\"')]),s._v(\" -m \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"说明信息\"')]),s._v(\" 容器  仓库名称:标签\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除全部容器\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" -f \"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$(\")]),s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\" -aq\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\")\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#设置容器自动启动\")]),s._v(\"\\ndocker update --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always 容器\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"数据卷管理\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#数据卷管理\"}},[s._v(\"#\")]),s._v(\" 数据卷管理\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#数据卷列表\")]),s._v(\"\\ndocker volume \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建数据卷\")]),s._v(\"\\ndocker volume create 数据卷名称\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除数据卷\")]),s._v(\"\\ndocker volume \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" 数据卷名称\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#清除没有挂载的数据卷\")]),s._v(\"\\ndocker volume prune\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看数据卷\")]),s._v(\"\\ndocker volume inspect 数据卷名称\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"网络管理\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络管理\"}},[s._v(\"#\")]),s._v(\" 网络管理\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看网络信息\")]),s._v(\"\\ndocker network \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\ndocker network create ‐‐subnet\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"网段 网络名称\\ndocker network \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" 网络名称\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"dockerfile\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#dockerfile\"}},[s._v(\"#\")]),s._v(\" Dockerfile\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考：https-docs-docker-com-develop-develop-images-dockerfile-best-practices\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考：https-docs-docker-com-develop-develop-images-dockerfile-best-practices\"}},[s._v(\"#\")]),s._v(\" 参考：\"),t(\"a\",{attrs:{href:\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#使用 Dockerfile 定制镜像\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"mkdir\")]),s._v(\" mynginx\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" mynginx\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"touch\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#文件内添加以下内容\")]),s._v(\"\\nFROM nginx\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'<h1>hello world</h1>'\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /usr/share/nginx/html/index.html\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#构建镜像 -f ../Dockerfile 参数指定某个⽂件作为 Dockerfile\")]),s._v(\"\\ndocker build -t nginx:v3 \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[t(\"p\",[s._v(\"FROM：定制的镜像都是基于 FROM 的镜像，这里的 nginx 就是定制需要的基础镜像。后续的操作都是基于 nginx。\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"RUN：用于执行后面跟着的命令行命令。\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"COPY：复制指令，从上下文目录中复制文件或者目录到容器里指定路径\")])])]),s._v(\" \"),t(\"p\",[s._v(\". 是上下文路径。上下文路径，是指 docker 在构建镜像，有时候想要使用到本机的文件（比如复制），docker build 命令得知这个路径后，会将路径下的所有内容打包。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"docker-还存在⼀个特殊的镜像，名为-scratch-。这个镜像是虚拟的概念，并不实际存在，它表示⼀个空⽩的镜像。\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-还存在⼀个特殊的镜像，名为-scratch-。这个镜像是虚拟的概念，并不实际存在，它表示⼀个空⽩的镜像。\"}},[s._v(\"#\")]),s._v(\" Docker 还存在⼀个特殊的镜像，名为 scratch 。这个镜像是虚拟的概念，并不实际存在，它表示⼀个空⽩的镜像。\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"FROM scratch\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"..\")]),s._v(\".\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大\")]),s._v(\" \"),t(\"p\",[s._v(\"Union FS 是有最⼤层数限制的，⽐如 AUFS，曾经是最⼤不得超过 42 层，现在是不得超过 127 层。\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"FROM debian:jessie\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" update\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" -y gcc libc6-dev \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\"\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" -O redis.tar.gz \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"http://download.redis.io/releases/redis-3.2.5.tar.gz\"')]),s._v(\"\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"mkdir\")]),s._v(\" -p /usr/src/redis\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"tar\")]),s._v(\" -xzf redis.tar.gz -C /usr/src/redis --strip-components\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\" -C /usr/src/redis\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\" -C /usr/src/redis \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#以上执行会创建7层镜像。可简化为以下格式：\")]),s._v(\"\\nFROM debian:jessie\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"buildDeps\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'gcc libc6-dev make'\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" update \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" -y \"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$buildDeps\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" -O redis.tar.gz \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"http://download.redis.io/releases/redis-3.2.5.tar.gz\"')]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"mkdir\")]),s._v(\" -p /usr/src/redis \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"tar\")]),s._v(\" -xzf redis.tar.gz -C /usr/src/redis --strip-components\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\" -C /usr/src/redis \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\" -C /usr/src/redis \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" -rf /var/lib/apt/lists/* \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" redis.tar.gz \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" -r /usr/src/redis \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" purge -y --auto-remove \"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$buildDeps\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#以 && 符号连接命令，这样执行后，只会创建 1 层镜像\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#Dockerfile ⽀持 Shell 类的⾏尾添加 \\\\ 的命令换⾏⽅式，以及⾏⾸ # 进⾏注释的格式。\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"私有镜像仓库\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#私有镜像仓库\"}},[s._v(\"#\")]),s._v(\" 私有镜像仓库\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"docker-hub\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-hub\"}},[s._v(\"#\")]),s._v(\" Docker Hub\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#在 https://cloud.docker.com 免费注册⼀个 Docker 账号\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#登录\")]),s._v(\"\\ndocker login\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#注销\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"logout\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#拉取镜像\")]),s._v(\"\\ndocker search\\ndocker pull\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#推送镜像\")]),s._v(\"\\ndocker tag 镜像名:标签 username/镜像名:标签\\ndocker push\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"私有仓库\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#私有仓库\"}},[s._v(\"#\")]),s._v(\" 私有仓库\")]),s._v(\" \"),t(\"p\",[s._v(\"docker-registry 是官⽅提供的⼯具，可以⽤于构建私有的镜像仓库。\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装官⽅ registry 镜像\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#默认情况下，仓库会被创建在容器的 /var/lib/registry ⽬录下\")]),s._v(\"\\ndocker run -d -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5000\")]),s._v(\":5000 --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always --name registry registry\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#上传镜像\")]),s._v(\"\\ndocker tag ubuntu:latest \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),s._v(\".0.1:5000/ubuntu:latest\\ndocker push \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),s._v(\".0.1:5000/ubuntu:latest\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#⽤ curl 查看仓库中的镜像\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),s._v(\".0.1:5000/v2/_catalog\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#搜索镜像\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#拉取镜像\")]),s._v(\"\\ndocker pull \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),s._v(\".0.1:5000/ubuntu:latest\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"如果你不想使⽤ 127.0.0.1:5000 作为仓库地址，⽐如想让本⽹段的其他主机也能把镜像推送到私有仓\\n库。你就得把例如 192.168.199.100:5000 这样的内⽹地址作为私有仓库地址，这时你会发现⽆法成功\\n推送镜像。\\n这是因为 Docker 默认不允许⾮ HTTPS ⽅式推送镜像。我们可以通过 Docker 的配置选项来取消这个\\n限制。\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/docker/daemon.json\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"registry-mirror\"')]),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\":\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://registry.docker-cn.com\"')]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\",\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"insecure-registries\"')]),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\":\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"192.168.199.100:5000\"')]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"避免 VM 虚拟机挂起恢复之后，Docker 虚拟机断网\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vi\")]),s._v(\" /etc/sysctl.conf\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#文件中添加 net.ipv4.ip_forward=1 这个配置\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#重启网络服务\")]),s._v(\"\\nsystemctl  restart network\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"docker-三架马车\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-三架马车\"}},[s._v(\"#\")]),s._v(\" Docker 三架马车\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"docker-compose\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-compose\"}},[s._v(\"#\")]),s._v(\" Docker Compose\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"介绍-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#介绍-2\"}},[s._v(\"#\")]),s._v(\" 介绍\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker Compose 是 Docker 官⽅编排（Orchestration）项⽬之⼀，负责快速的部署分布式应⽤。其代\\n码⽬前在https://github.com/docker/compose上开源。Compose 定位是 「定义和运⾏多个 Docker 容\\n器的应⽤（Defining and running multi-container Docker applications）」，其前身是开源项⽬ Fig 。\")]),s._v(\" \"),t(\"p\",[s._v(\"在⽇常⼯作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如要实现⼀个 Web 项\\n⽬，除了 Web 服务容器本身，往往还需要再加上后端的数据库服务容器或者缓存服务容器，甚⾄还包\\n括负载均衡容器等。Compose 恰好满⾜了这样的需求。它允许⽤户通过⼀个单独的 dockercompose.yml 模板⽂件（YAML 格式）来定义⼀组相关联的应⽤容器为⼀个项⽬（project）。\")]),s._v(\" \"),t(\"p\",[s._v(\"Compose 中有两个重要的概念：\")]),s._v(\" \"),t(\"p\",[s._v(\"服务 (service)：⼀个应⽤的容器，实际上可以包括若⼲运⾏相同镜像的容器实例。\")]),s._v(\" \"),t(\"p\",[s._v(\"项⽬ (project)：由⼀组关联的应⽤容器组成的⼀个完整业务单元，在 docker-compose.yml ⽂件中\\n定义。\")]),s._v(\" \"),t(\"p\",[s._v(\"Compose 的默认管理对象是项⽬，通过⼦命令对项⽬中的⼀组容器进⾏便捷地⽣命周期管理。\")]),s._v(\" \"),t(\"p\",[s._v(\"Compose 项⽬由 Python 编写，实现上调⽤了 Docker 服务提供的 API 来对容器进⾏管理。所以只要\\n所操作的平台⽀持 Docker API，就可以在其上利⽤ Compose 来进⾏编排管理。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装与卸载\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装与卸载\"}},[s._v(\"#\")]),s._v(\" 安装与卸载\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"⼆进制安装与卸载\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -L https://github.com/docker/compose/releases/download/1.25.4/docker-compose-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -s\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -m\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\" -o /usr/local/bin/docker-compose\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" +x /usr/local/bin/docker-compose\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#卸载\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" /usr/local/bin/docker-compose\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"参考-https-github-com-docker-compose-releases\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-https-github-com-docker-compose-releases\"}},[s._v(\"#\")]),s._v(\" 参考: \"),t(\"a\",{attrs:{href:\"https://github.com/docker/compose/releases\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://github.com/docker/compose/releases\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"PIP 安装与卸载\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装\")]),s._v(\"\\npip \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" -U docker-compose\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#bash 补全命令\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -L https://raw.githubusercontent.com/docker/compose/1.8.0/contrib/completion/bash/d\\nocker-compose \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /etc/bash_completion.d/docker-compose\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#卸载\")]),s._v(\"\\npip uninstall docker-compose\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"容器中执⾏\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -L https://github.com/docker/compose/releases/download/1.25.5/run.sh \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /usr/local/bi\\nn/docker-compose\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" +x /usr/local/bin/docker-compose\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"查看-docker-compose-版本\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#查看-docker-compose-版本\"}},[s._v(\"#\")]),s._v(\" 查看 docker-compose 版本\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker-compose --version\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"使用-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#使用-2\"}},[s._v(\"#\")]),s._v(\" 使用\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"mkdir\")]),s._v(\" composetest\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" composetest\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建   app.py 文件\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"import\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"time\")]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"import\")]),s._v(\" redis\\nfrom flask \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"import\")]),s._v(\" Flask\\n\\napp \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" Flask\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"__name__\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\ncache \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" redis.Redis\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"host\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'redis'\")]),s._v(\", \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"port\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"6379\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\\n\\ndef get_hit_count\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\":\\n    retries \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"while\")]),s._v(\" True:\\n        try:\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"return\")]),s._v(\" cache.incr\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'hits'\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n        except redis.exceptions.ConnectionError as exc:\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" retries \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"==\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0\")]),s._v(\":\\n                raise exc\\n            retries -\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n            time.sleep\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0.5\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\\n\\n@app.route\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/'\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\ndef hello\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\":\\n    count \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" get_hit_count\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"return\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'Hello World! I have been seen {} times.\"),t(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[s._v(\"\\\\n\")]),s._v(\"'\")]),s._v(\".format\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"count\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建  requirements.txt 文件\")]),s._v(\"\\nflask\\nredis\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建 Dockerfile 文件\")]),s._v(\"\\nFROM python:3.7-alpine\\nWORKDIR /code\\nENV FLASK_APP app.py\\nENV FLASK_RUN_HOST \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0.0\")]),s._v(\".0.0\\nRUN apk \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"add\")]),s._v(\" --no-cache gcc musl-dev linux-headers\\nCOPY requirements.txt requirements.txt\\nRUN pip \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" -r requirements.txt\\nCOPY \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\nCMD \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"flask\"')]),s._v(\", \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"run\"')]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建 docker-compose.yml文件\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# yaml 配置\")]),s._v(\"\\nversion: \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'3'\")]),s._v(\"\\nservices:\\n  web:\\n    build: \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\n    ports:\\n     - \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"5000:5000\"')]),s._v(\"\\n  redis:\\n    image: \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"redis:alpine\"')]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#运行 compose 项目\")]),s._v(\"\\ndocker-compose up -d\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#重启 compose 项目\")]),s._v(\"\\ndocker-compose restart\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除 compose 项目\")]),s._v(\"\\ndocker-compose down\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#构建 compose 项目\")]),s._v(\"\\ndocker-compose build\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"52\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"53\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"54\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"55\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"56\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"57\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"58\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"59\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"docker-machine\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-machine\"}},[s._v(\"#\")]),s._v(\" Docker Machine\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"介绍-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#介绍-3\"}},[s._v(\"#\")]),s._v(\" 介绍\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker Machine 是 Docker 官⽅编排（Orchestration）项⽬之⼀，负责在多种平台上快速安装 Docker\\n环境。\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker Machine 项⽬基于 Go 语⾔实现，⽬前在 Github 上进⾏维护。\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker Machine 是 Docker 官⽅提供的⼀个⼯具，它可以帮助我们在远程的机器上安装 Docker，或者\\n在虚拟机 host 上直接安装虚拟机并在虚拟机中安装 Docker。我们还可以通过 docker-machine 命令来\\n管理这些虚拟机和 Docker。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-2\"}},[s._v(\"#\")]),s._v(\" 安装\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" -L https://github.com/docker/machine/releases/download/v0.16.2/docker-machine-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -s\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -m\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\"/tmp/docker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" +x /tmp/docker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"cp\")]),s._v(\" /tmp/docker-machine /usr/local/bin/docker-machine\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"参考-https-github-com-docker-machine-releases\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-https-github-com-docker-machine-releases\"}},[s._v(\"#\")]),s._v(\" 参考: \"),t(\"a\",{attrs:{href:\"https://github.com/docker/machine/releases\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://github.com/docker/machine/releases\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"h4\",{attrs:{id:\"查看-docker-machine-版本\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#查看-docker-machine-版本\"}},[s._v(\"#\")]),s._v(\" 查看 docker-machine 版本\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker-machine -v\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"使用-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#使用-3\"}},[s._v(\"#\")]),s._v(\" 使用\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#列出可用的机器\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#显示连接主机的配置\")]),s._v(\"\\ndocker-machine config\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建机器\")]),s._v(\"\\ndocker-machine create -d virtualbox \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#显示连接到某个主机需要的环境变量\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看机器的 ip\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ip\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#停止机器\")]),s._v(\"\\ndocker-machine stop \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#启动机器\")]),s._v(\"\\ndocker-machine start \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#进入机器\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ssh\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#移除机器\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v('Error with pre-create check: \"VBoxManage not found. Make sure VirtualBox is installed and VBoxManage is in the path\"')])]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"yum 安装 VirtualBox\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#导入epel安装源\")]),s._v(\"\\nyum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" epel-release\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#添加VirtualBox安装源\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /etc/yum.repos.d/\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装相关依赖包\")]),s._v(\"\\nyum update\\nyum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" binutils qt gcc \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"make\")]),s._v(\" patch libgomp glibc-headers glibc-devel kernel-headers kernel-devel dkms\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装VirtualBox\")]),s._v(\"\\nyum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" VirtualBox-5.2\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#构建内核模块并启动VirtualBox\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" /sbin/vboxconfig\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"源码安装 VirtualBox \"),t(\"a\",{attrs:{href:\"https://www.virtualbox.org/wiki/Linux_Downloads\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://www.virtualbox.org/wiki/Linux_Downloads\"),t(\"OutboundLink\")],1)])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#添加公钥\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" https://www.virtualbox.org/download/oracle_vbox.asc\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rpm\")]),s._v(\" --import oracle_vbox.asc\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装vitualbox\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" https://download.virtualbox.org/virtualbox/5.2.40/VirtualBox-5.2-5.2.40_137108_el7-1.x86_64.rpm\\nyum localinstall VirtualBox-5.2-5.2.40_137108_el7-1.x86_64.rpm\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v('Error with pre-create check: \"We support Virtualbox starting with version 5. Your VirtualBox install is \"WARNING: The vboxdrv kernel module is not loaded. Either there is no module\\\\n available for the current kernel (3.10.0-1062.el7.x86_64) or it failed to\\\\n load. Please recompile the kernel module and install it by\\\\n\\\\n sudo /sbin/vboxconfig\\\\n\\\\n You will not be able to start VMs until this problem is fixed.\\\\n5.2.40r137108\". Please upgrade at https://www.virtualbox.org')])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" kernel-headers-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$(\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -r\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\")\")])]),s._v(\" kernel-devel-\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$(\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"uname\")]),s._v(\" -r\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\")\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看系统上所有可用的内核\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"awk\")]),s._v(\" -F \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"' \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$1\")]),s._v('==\"menuentry \" {print i++ \" : \" '),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$2\")]),s._v(\"}'\")]),s._v(\" /etc/grub2.cfg\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#切换内核版本\")]),s._v(\"\\ngrub2-set-default \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#重启\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"reboot\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" /sbin/vboxconfig\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\")])]),t(\"h3\",{attrs:{id:\"docker-swarm\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-swarm\"}},[s._v(\"#\")]),s._v(\" Docker Swarm\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"介绍-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#介绍-4\"}},[s._v(\"#\")]),s._v(\" 介绍\")]),s._v(\" \"),t(\"p\",[s._v(\"Swarm 是使⽤ SwarmKit 构建的 Docker 引擎内置（原⽣）的集群管理和编排⼯具。 Docker Swarm 是\\nDocker 官⽅三剑客项⽬之⼀，提供 Docker 容器集群服务，是 Docker 官⽅对容器云⽣态进⾏⽀持的\\n核⼼⽅案。\")]),s._v(\" \"),t(\"p\",[s._v(\"使⽤它，⽤户可以将多个 Docker 主机封装为单个⼤型的虚拟 Docker 主机，快速打造⼀套容器云平\\n台。Swarm mode 内置 kv 存储功能，提供了众多的新特性，⽐如：具有容错能⼒的去中⼼化设计、内\\n置服务发现、负载均衡、路由⽹格、动态伸缩、滚动更新、安全传输等。使得 Docker 原⽣的 Swarm\\n集群具备与 Mesos 、 Kubernetes 竞争的实⼒。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"使用-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#使用-4\"}},[s._v(\"#\")]),s._v(\" 使用\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#初始化集群\")]),s._v(\"\\ndocker-machine create -d virtualbox manager\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" manager\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"eval\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$(\")]),s._v(\"docker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" manager\"),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\")\")])]),s._v(\"\\n\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ssh\")]),s._v(\" manager\\ndocker swarm init --advertise-addr \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".99.100\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#增加⼯作节点\")]),s._v(\"\\ndocker-machine create -d virtualbox worker1\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ssh\")]),s._v(\" worker1\\ndocker swarm \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"join\")]),s._v(\" --token SWMTKN-1-5j2023jo6yn493n00b0iecuevsg4poh6l3o0fplcghud6udibo-8o35q16ax1tf46xwf1d1fhx5g \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".99.100:2377\\ndocker-machine create -d virtualbox worker2\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ssh\")]),s._v(\" worker2\\ndocker swarm \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"join\")]),s._v(\" --token SWMTKN-1-5j2023jo6yn493n00b0iecuevsg4poh6l3o0fplcghud6udibo-8o35q16ax1tf46xwf1d1fhx5g \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".99.100:2377\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看集群\")]),s._v(\"\\ndocker node \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\ndocker-machine \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#安装nginx服务\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" create --replicas \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),s._v(\" -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"80\")]),s._v(\":80 --name nginx nginx:latest\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看某个服务的⽇志\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" logs nginx\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#从 Swarm 集群移除某个服务\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" nginx\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"部署-wordpress\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#部署-wordpress\"}},[s._v(\"#\")]),s._v(\" 部署 WordPress\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#docker-compose.yml 其中constraints: [node.role == manager]是调度策略\")]),s._v(\"\\nversion: \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'3'\")]),s._v(\"\\n\\nservices:\\n  wordpress:\\n    image: wordpress\\n    ports:\\n      - \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"80\")]),s._v(\":80\\n    networks:\\n      - overlay\\n    environment:\\n      WORDPRESS_DB_HOST: db:3306\\n      WORDPRESS_DB_USER: wordpress\\n      WORDPRESS_DB_PASSWORD: wordpress\\n    deploy:\\n      mode: replicated\\n      replicas: \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),s._v(\"\\n\\n  db:\\n    image: mysql\\n    networks:\\n      - overlay\\n    volumes:\\n      - db-data:/var/lib/mysql\\n    environment:\\n      MYSQL_ROOT_PASSWORD: somewordpress\\n      MYSQL_DATABASE: wordpress\\n      MYSQL_USER: wordpress\\n      MYSQL_PASSWORD: wordpress\\n    deploy:\\n      placement:\\n        constraints: \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"node.role \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"==\")]),s._v(\" manager\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\\n  visualizer:\\n    image: dockersamples/visualizer:stable\\n    ports:\\n      - \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"8080:8080\"')]),s._v(\"\\n    stop_grace_period: 1m30s\\n    volumes:\\n      - \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"/var/run/docker.sock:/var/run/docker.sock\"')]),s._v(\"\\n    deploy:\\n      placement:\\n        constraints: \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"node.role \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"==\")]),s._v(\" manager\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\\nvolumes:\\n  db-data:\\nnetworks:\\n  overlay:\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#部署服务\")]),s._v(\"\\ndocker stack deploy -c docker-compose.yml wordpress\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看服务\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\ndocker stack \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#移除服务 该命令不会移除服务所使⽤的 数据卷 ，如果你想移除数据卷请使⽤ docker volume rm\")]),s._v(\"\\ndocker stack down wordpress\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"52\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"53\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"54\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"55\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"56\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"图形化管理和监控工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#图形化管理和监控工具\"}},[s._v(\"#\")]),s._v(\" 图形化管理和监控工具\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"portainer\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#portainer\"}},[s._v(\"#\")]),s._v(\" Portainer\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考：https-www-portainer-io\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考：https-www-portainer-io\"}},[s._v(\"#\")]),s._v(\" 参考：\"),t(\"a\",{attrs:{href:\"https://www.portainer.io/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://www.portainer.io/\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"p\",[s._v(\"Portainer（基于 Go）是⼀个轻量级的管理界⾯，可让您轻松管理 Docker 主机或 Swarm 集群。\")]),s._v(\" \"),t(\"p\",[s._v(\"Portainer 的使⽤意图是简单部署。它包含可以在任何 Docker 引擎上运⾏的单个容器（Docker for\\nLinux 和 Docker for Windows）。\")]),s._v(\" \"),t(\"p\",[s._v(\"Portainer 允许您管理 Docker 容器、image、volume、network 等。 它与独⽴的 Docker 引擎和\\nDocker Swarm 兼容。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装-portainer\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-portainer\"}},[s._v(\"#\")]),s._v(\" 安装 Portainer\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker volume create portainer_data\\ndocker run -d -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9000\")]),s._v(\":9000 --name\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"portainer --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#拉取portainer镜像\")]),s._v(\"\\ndocker pull portainer/portainer\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#开放 Docker 网络管理端口\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/sysconfig/docker\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#在配置文件结尾添加开放 Docker2375 端口的参数\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"OPTIONS\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'-Htcp://0.0.0.0:2375 -H unix:///var/run/docker.sock'\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#启动 Portainer 容器\")]),s._v(\"\\ndocker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9000\")]),s._v(\":9000 portainer/portainer -H tcp://192.168.123.36:2375\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"需要开放 2375 和 9000 端口\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"firewall-cmd --permanent --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2375\")]),s._v(\"/tcp\\nfirewall-cmd --permanent --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9000\")]),s._v(\"/tcp\\nfirewall-cmd --reload\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"访问-http-192-168-123-36-9000\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#访问-http-192-168-123-36-9000\"}},[s._v(\"#\")]),s._v(\" 访问 http://192.168.123.36:9000\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"rancher\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#rancher\"}},[s._v(\"#\")]),s._v(\" Rancher\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考：https-rancher-com\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考：https-rancher-com\"}},[s._v(\"#\")]),s._v(\" 参考：\"),t(\"a\",{attrs:{href:\"https://rancher.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://rancher.com/\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"p\",[s._v(\"Rancher 是⼀个开源的企业级容器管理平台。通过 Rancher ，企业不必⾃⼰使⽤⼀系列的开源软件去\\n从头搭建容器服务平台。 Rancher 提供了在⽣产环境中使⽤管理 Docker 和 Kubernetes 的全栈化容器\\n部署与管理平台。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"cadvisor\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#cadvisor\"}},[s._v(\"#\")]),s._v(\" cAdvisor\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考：https-github-com-google-cadvisor\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考：https-github-com-google-cadvisor\"}},[s._v(\"#\")]),s._v(\" 参考：\"),t(\"a\",{attrs:{href:\"https://github.com/google/cadvisor\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://github.com/google/cadvisor\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"p\",[s._v(\"cAdvisor 是 Google 开发的容器监控⼯具。\")]),s._v(\" \"),t(\"p\",[s._v(\"监控 Docker Host cAdvisor 会显示当前 host 的资源使⽤情况，包括 CPU、内存、⽹络、⽂件系\\n统等。\")]),s._v(\" \"),t(\"p\",[s._v(\"监控容器 点击 Docker Containers 链接，显示容器列表。点击某个容器，⽐如 sysdig，进⼊该容\\n器的监控⻚⾯。\")]),s._v(\" \"),t(\"p\",[s._v(\"以上就是 cAdvisor 的主要功能，总结起来主要两点：展示 Host 和容器两个层次的监控数据。展示历史变化数据。\")]),s._v(\" \"),t(\"p\",[s._v(\"由于 cAdvisor 提供的操作界⾯略显简陋，⽽且需要在不同⻚⾯之间跳转，并且只能监控⼀个 host，\\n这不免会让⼈质疑它的实⽤性。但 cAdvisor 的⼀个亮点是它可以将监控到的数据导出给第三⽅⼯具，\\n由这些⼯具进⼀步加⼯处理。\")]),s._v(\" \"),t(\"p\",[s._v(\"我们可以把 cAdvisor 定位为⼀个监控数据收集器，收集和导出数据是它的强项，⽽⾮展示数据。\\ncAdvisor ⽀持很多第三⽅⼯具。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装-cadvisor\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-cadvisor\"}},[s._v(\"#\")]),s._v(\" 安装 cAdvisor\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --volume\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/:/rootfs:ro \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --volume\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/var/run:/var/run:ro \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --volume\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/sys:/sys:ro \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --volume\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/var/lib/docker/:/var/lib/docker:ro \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --volume\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/dev/disk/:/dev/disk:ro \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --publish\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8080\")]),s._v(\":8080 \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --detach\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"true \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  --name\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"cadvisor \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n  google/cadvisor:latest\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"访问-http-192-168-123-36-8080-containers\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#访问-http-192-168-123-36-8080-containers\"}},[s._v(\"#\")]),s._v(\" 访问 http://192.168.123.36:8080/containers/\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"cadvisor-还提供了⼀个-rest-api：https-github-com-google-cadvisor-blob-master-docs-api-md-cadvisor-通过该-rest-api-暴露监控数据，格式如下：\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#cadvisor-还提供了⼀个-rest-api：https-github-com-google-cadvisor-blob-master-docs-api-md-cadvisor-通过该-rest-api-暴露监控数据，格式如下：\"}},[s._v(\"#\")]),s._v(\" cAdvisor 还提供了⼀个 Rest API：https://github.com/google/cadvisor/blob/master/docs/api.md cAdvisor 通过该 REST API 暴露监控数据，格式如下：\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"http://\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"hostname\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\":\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\"/api/\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"version\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\"/\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"request\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"多阶段构建\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#多阶段构建\"}},[s._v(\"#\")]),s._v(\" 多阶段构建\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker 17.05 版本以后，官⽅就提供了⼀\\n个新的特性： Multi-stage builds （多阶段构建）。 使⽤多阶段构建，你可以在⼀个 Dockerfile\\n中使⽤多个 FROM 语句。每个 FROM 指令都可以使⽤不同的基础镜像，并表示开始⼀个新的构建阶\\n段。你可以很⽅便的将⼀个阶段的⽂件复制到另外⼀个阶段，在最终的镜像中保留下你需要的内容即\\n可。\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#Dockerfile\")]),s._v(\"\\nFROM golang AS build-env\\nADD \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\" /go/src/app\\nWORKDIR /go/src/app\\nRUN go get -u -v github.com/kardianos/govendor\\nRUN govendor \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sync\")]),s._v(\"\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"GOOS\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"linux \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"GOARCH\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"386\")]),s._v(\" go build -v -o /go/src/app/app-server\\n\\nFROM alpine\\nRUN apk \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"add\")]),s._v(\" -U tzdata\\nRUN \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ln\")]),s._v(\" -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\\nCOPY --from\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"build-env /go/src/app/app-server /usr/local/bin/app-server\\nEXPOSE \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8080\")]),s._v(\"\\nCMD \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"app-server\"')]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#构建\")]),s._v(\"\\ndocker build -t lalifeier/docker-multi-stage-demo:latest \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#测试\")]),s._v(\"\\ndocker run --rm -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8080\")]),s._v(\":8080 lalifeier/docker-multi-stage-demo:latest\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"swarm-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#swarm-集群\"}},[s._v(\"#\")]),s._v(\" Swarm 集群\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考-https-docs-docker-com-engine-swarm\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-https-docs-docker-com-engine-swarm\"}},[s._v(\"#\")]),s._v(\" 参考: \"),t(\"a\",{attrs:{href:\"https://docs.docker.com/engine/swarm\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://docs.docker.com/engine/swarm\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"h4\",{attrs:{id:\"创建-swarm-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建-swarm-集群\"}},[s._v(\"#\")]),s._v(\" 创建 Swarm 集群\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建Swarm集群（该节点自动变成管理节点）\")]),s._v(\"\\ndocker swarm init\\n--listen-addr ip:port 管理者节点\\n--advertise-addr \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ip\")]),s._v(\" 广播地址\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"需要在 manager 机器开放 2377 端口，否则会出现如下错误\")]),s._v(\" \"),t(\"p\",[s._v(\"Error response from daemon: rpc error: code = 14 desc = grpc: the connection is unavailable\")]),s._v(\" \"),t(\"p\",[s._v(\"Error response from daemon: can't initialize raft node: rpc error: code = 2 desc = could not connect to prospective new cluster member using its advertised address: rpc error: code = 14 desc = grpc: the connection is unavailable\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"firewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2377\")]),s._v(\"/tcp --permanent\\nfirewall-cmd --reload\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"加入-swarm-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#加入-swarm-集群\"}},[s._v(\"#\")]),s._v(\" 加入 Swarm 集群\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker swarm join-token manager\\ndocker swarm join-token worker\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"p\",[s._v(\"在 manager 和 worker 机器分别执行相应的 docker swarm join --token\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"查看-swarm-集群节点\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#查看-swarm-集群节点\"}},[s._v(\"#\")]),s._v(\" 查看 Swarm 集群节点\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker node \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"退出-swarm-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#退出-swarm-集群\"}},[s._v(\"#\")]),s._v(\" 退出 Swarm 集群\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"主动退出\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Manager退出集群必须要使用-f参数\")]),s._v(\"\\ndocker swarm leave -f\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"被动退出\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Manager节点必须先降级成Worker节点,然后再去删除\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Manager节点降级为Worker节点\")]),s._v(\"\\ndocker node demote 节点ID\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 删除停止或离开的Worker节点\")]),s._v(\"\\ndocker node \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" 节点ID -f\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"swarm-虚拟网络\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#swarm-虚拟网络\"}},[s._v(\"#\")]),s._v(\" Swarm 虚拟网络\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看虚拟网络\")]),s._v(\"\\ndocker network \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ls\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建虚拟网络\")]),s._v(\"\\ndocker network create -d overlay --attachable 虚拟网络名称\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#删除虚拟网络（先删除该网络上部署的容器）\")]),s._v(\"\\ndocker network \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" 虚拟网络名称\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"p\",[s._v(\"Swarm 虚拟网络使用三个端口，所以必须要在防火墙上面开启 2377、7946、4789 端口\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"firewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2377\")]),s._v(\"/tcp --permanent\\nfirewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"7946\")]),s._v(\"/tcp --permanent\\nfirewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"7946\")]),s._v(\"/udp --permanent\\nfirewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4789\")]),s._v(\"/tcp --permanent\\nfirewall-cmd --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4789\")]),s._v(\"/udp --permanent\\nfirewall-cmd --reload\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"p\",[s._v(\"开启防火墙端口之后，必须要重新启动 Docker 服务\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"systemctl  restart network\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"退出-swarm-集群-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#退出-swarm-集群-2\"}},[s._v(\"#\")]),s._v(\" 退出 Swarm 集群\")]),s._v(\" \"),t(\"h2\",{attrs:{id:\"pxc-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#pxc-集群\"}},[s._v(\"#\")]),s._v(\" PXC 集群\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"Pecona XtraDB Cluster 是业界主流的 MySQL 集群方案\")]),s._v(\" \"),t(\"li\",[s._v(\"PXC 集群的数据同步具有强一致性的特点\")]),s._v(\" \"),t(\"li\",[s._v(\"PXC 集群只支持 InnoDB 引擎\")]),s._v(\" \"),t(\"li\",[s._v(\"PXC 集群中 MySQL 节点的数量最好不要超过 15 个，集群规模越大，读写速度越慢\")])]),s._v(\" \"),t(\"h4\",{attrs:{id:\"下载-pxc-镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#下载-pxc-镜像\"}},[s._v(\"#\")]),s._v(\" 下载 PXC 镜像\")]),s._v(\" \"),t(\"p\",[s._v(\"因为 PXC 镜像更新频率很高，新版本的镜像稳定性有待检验，推荐安装最稳定的 5.7.21 版本\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 拉取镜像\")]),s._v(\"\\ndocker pull percona/percona-xtradb-cluster\\ndocker pull percona/percona-xtradb-cluster:5.7.21\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 镜像重命名\")]),s._v(\"\\ndocker tag percona/percona-xtradb-cluster pxc\\ndocker rmi percona/percona-xtradb-cluster\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建主节点容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建主节点容器\"}},[s._v(\"#\")]),s._v(\" 创建主节点容器\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"第一个启动的 PXC 节点是主节点，它要初始化 PXC 集群\")]),s._v(\" \"),t(\"li\",[s._v(\"PXC 启动之后，就没有主节点的角色了\")]),s._v(\" \"),t(\"li\",[s._v(\"PXC 集群中任何节点都是可以读写数据\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9001\")]),s._v(\":3306 -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"CLUSTER_NAME\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"PXC -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"XTRABACKUP_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -v pnv1:/var/lib/mysql --privileged --name\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"pn1 --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"swarm_mysql pxc\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"p\",[s._v(\"创建主节点之后，稍等一会儿，才能连接\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"创建从节点容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建从节点容器\"}},[s._v(\"#\")]),s._v(\" 创建从节点容器\")]),s._v(\" \"),t(\"p\",[s._v(\"必须主节点可以访问了，才能创建从节点，否则会闪退\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9001\")]),s._v(\":3306 -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"CLUSTER_NAME\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"PXC -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"XTRABACKUP_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"CLUSTER_JOIN\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"pn1 -v pnv2:/var/lib/mysql --privileged --name\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"pn2 --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"swarm_mysql pxc\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"div\",{staticClass:\"custom-block warning\"},[t(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"WARNING\")]),s._v(\" \"),t(\"p\",[s._v(\"解决虚拟机重启后 Percona XtraDB Cluster(PXC)容器无法正常启动\")]),s._v(\" \"),t(\"p\",[s._v(\"docker logs node1\")]),s._v(\" \"),t(\"p\",[s._v(\"[ERROR] WSREP: It may not be safe to bootstrap the cluster from this node. It was not the last one to leave the cluster and may not contain all the updates. To force cluster bootstrap with this node, edit the grastate.dat file manually and set safe_to_bootstrap to 1\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#查看node1挂载点的文件地址\")]),s._v(\"\\ndocker volume inspect v1\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#进入/var/lib/docker/volumes/v1/_data目录下\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /var/lib/docker/volumes/v1/_data\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#编辑文件grastate.dat\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" grastate.dat\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#修改safe_to_bootstrap的值置为1\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# GALERA saved state\")]),s._v(\"\\nversion: \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2.1\")]),s._v(\"\\nuuid:    1fdc4f95-9625-11e9-9a33-a20935d979f9\\nseqno:   -1\\nsafe_to_bootstrap: \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"pxc-容器闪退的解决办法\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#pxc-容器闪退的解决办法\"}},[s._v(\"#\")]),s._v(\" PXC 容器闪退的解决办法\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"p\",[s._v(\"主节点无法启动\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"p\",[s._v(\"PXC 启动之后，所有节点的 safe_to_bootstrap 都是 0\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"如果所有 PXC 节点同时意外关闭，所有节点 safe_to_bootstrap 都是 0.所以主节点无法启动\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"修改/var/lib/mysql/grastate.dat 文件，把 safe_to_bootstrap 参数改成 1，然后就能启动了\")])])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"如果 PXC 集群正在运行，宕机的主节点不能按照主节点启动\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"删除容器，检查 safe_to_bootstrap 是否为 0\")]),s._v(\" \"),t(\"li\",[s._v(\"以从节点方式创建容器，加入集群\")])])])])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"从节点闪退的原因\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"p\",[s._v(\"如果主节点没有完全启动成功，从节点就会闪退\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"PXC 最后退出的节点要最先启动，而且要按照主节点启动\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"修改 grastate.dat 文件，把 safe_to_bootstrap 参数改成 0\")]),s._v(\" \"),t(\"li\",[s._v(\"safe_to_bootstrap 等于 1，代表该节点是最后退出的节点，需要按照主节点启动\")])])])])])]),s._v(\" \"),t(\"h2\",{attrs:{id:\"replication-集群\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#replication-集群\"}},[s._v(\"#\")]),s._v(\" Replication 集群\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"Replication 集群是 MySQL 自带的数据同步机制\")]),s._v(\" \"),t(\"li\",[s._v(\"MySQL 通过读取、执行另一个 MySQL 的 bin_log 日志，实现数据同步\")]),s._v(\" \"),t(\"li\",[s._v(\"Replication 集群中，数据同步是单向的，从主节点(Master)同步到从节点(Slave)\")])]),s._v(\" \"),t(\"h4\",{attrs:{id:\"下载-replication-镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#下载-replication-镜像\"}},[s._v(\"#\")]),s._v(\" 下载 Replication 镜像\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 拉取镜像\")]),s._v(\"\\ndocker pull mishamx/mysql\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 镜像重命名\")]),s._v(\"\\ndocker tag mishamx/mysql rep\\ndocker rmi mishamx/mysql\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建主节点容器-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建主节点容器-2\"}},[s._v(\"#\")]),s._v(\" 创建主节点容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9003\")]),s._v(\":3306 --name rn1 -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_MASTER_PORT\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_REPLICATION_USER\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"backup -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_REPLICATION_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"backup123 -v rnv1:/var/lib/mysql --privileged --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"swarm_mysql rep\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建从节点容器-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建从节点容器-2\"}},[s._v(\"#\")]),s._v(\" 创建从节点容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9003\")]),s._v(\":3306 --name rn2 -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_MASTER_HOST\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"rn1 -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_MASTER_PORT\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_REPLICATION_USER\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"backup -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_REPLICATION_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"backup123 -v rnv2:/var/lib/mysql --privileged --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"swarm_mysql rep\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"replication-集群注意事项\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#replication-集群注意事项\"}},[s._v(\"#\")]),s._v(\" Replication 集群注意事项\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"主节点关闭，从节点依然可以使用，主从同步机制失效\")]),s._v(\" \"),t(\"li\",[s._v(\"不启动主节点，从节点也能启动，主从同步失效\")])]),s._v(\" \"),t(\"h2\",{attrs:{id:\"mycat\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#mycat\"}},[s._v(\"#\")]),s._v(\" MyCat\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"MyCat 是基于 Java 语言的开源数据库中间件产品，具有跨平台性\")]),s._v(\" \"),t(\"li\",[s._v(\"相较于其他中间件产品，MyCat 的切分规则最多，功能最全\")]),s._v(\" \"),t(\"li\",[s._v(\"数据库中间件产品并不会频繁更新升级，MyCat 功能非常成熟\")])]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考-http-mycat-io\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-http-mycat-io\"}},[s._v(\"#\")]),s._v(\" 参考: \"),t(\"a\",{attrs:{href:\"http://mycat.io\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"http://mycat.io\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装-jdk-镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-jdk-镜像\"}},[s._v(\"#\")]),s._v(\" 安装 JDK 镜像\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker pull adoptopenjdk/openjdk8\\ndocker tag adoptopenjdk/openjdk8 openjdk8\\ndocker rmi adoptopenjdk/openjdk8\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建-java-容器，在数据卷放入-mycat\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建-java-容器，在数据卷放入-mycat\"}},[s._v(\"#\")]),s._v(\" 创建 Java 容器，在数据卷放入 MyCat\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker run -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -it --name mycat1 -v mycat1:/root/server --privileged --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"host  openjdk8\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"开启端口\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#开启端口\"}},[s._v(\"#\")]),s._v(\" 开启端口\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"firewall-cmd --permanent --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8066\")]),s._v(\"/tcp\\nfirewall-cmd --permanent --zone\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"public --add-port\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"9066\")]),s._v(\"/tcp\\nfirewall-cmd --reload\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"安装-mycat\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-mycat\"}},[s._v(\"#\")]),s._v(\" 安装 MyCat\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker volume inspect mycat1\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /var/lib/docker/volumes/mycat1/_data\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" http://dl.mycat.io/1.6.7.4/Mycat-server-1.6.7.4-release/Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"tar\")]),s._v(\" -xvf Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz\\n\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it mycat1 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /root/server/mycat\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"mycat-到底是什么\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#mycat-到底是什么\"}},[s._v(\"#\")]),s._v(\" MyCat 到底是什么?\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"MyCat 是 MySQL 数据库中间件产品，运行的时候会把自己虚拟成数据库，包括虚拟的逻辑库和数据表\")])]),s._v(\" \"),t(\"h4\",{attrs:{id:\"mycat-主要的配置文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#mycat-主要的配置文件\"}},[s._v(\"#\")]),s._v(\" MyCat 主要的配置文件\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"server.xml Mycat 服务器参数调整和用户授权的配置文件\")]),s._v(\" \"),t(\"li\",[s._v(\"schema.xml 逻辑库定义和表以及分片定义的配置文件\")]),s._v(\" \"),t(\"li\",[s._v(\"rule.xml 分片规则的配置文件\")])]),s._v(\" \"),t(\"h4\",{attrs:{id:\"配置-server-xml-文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置-server-xml-文件\"}},[s._v(\"#\")]),s._v(\" 配置 server.xml 文件\")]),s._v(\" \"),t(\"p\",[s._v(\"可以配置端口号、账号信息、全局主键方式等等\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"user\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"admin\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"defaultAccount\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"true\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"property\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"password\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"property\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"property\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"schemas\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"property\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"配置-pxc-集群负载均衡\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置-pxc-集群负载均衡\"}},[s._v(\"#\")]),s._v(\" 配置 PXC 集群负载均衡\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"修改 schema.xml 文件，加入 PXC 集群负载均衡的内容\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"maxCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1000\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"minCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"10\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"balance\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"0\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"writeType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mysql\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbDriver\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"native\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"switchType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"slaveThreshold\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"select user()\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p1w1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.36:9001\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p1w2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.162:9001\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p1w3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.104:9001\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p1w4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.11:9001\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"maxCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1000\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"minCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"10\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"balance\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"0\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"writeType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mysql\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbDriver\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"native\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"switchType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"slaveThreshold\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"select user()\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p2w1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.36:9002\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p2w2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.162:9002\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p2w3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.104:9002\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"p2w4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.11:9002\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"配置-replication-集群读写分离\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置-replication-集群读写分离\"}},[s._v(\"#\")]),s._v(\" 配置 Replication 集群读写分离\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"修改 schema.xml 文件，加入 读写分离的配置\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"maxCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1000\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"minCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"10\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"balance\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"writeType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mysql\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbDriver\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"native\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"switchType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"slaveThreshold\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"select user()\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r1w1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.36:9003\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r1r1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.162:9003\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                                \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r1r2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.104:9003\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r1r3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.11:9003\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"maxCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1000\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"minCon\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"10\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"balance\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                        \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"writeType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mysql\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dbDriver\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"native\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"switchType\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"slaveThreshold\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"select user()\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"heartbeat\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"writeHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r2w1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.36:9004\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r2r1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.162:9004\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r2r2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.104:9004\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"readHost\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"host\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"r2r3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"url\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"192.168.123.11:9004\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"root\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"\\n                            \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"password\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"readHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"writeHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"配置虚拟库和虚拟表\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置虚拟库和虚拟表\"}},[s._v(\"#\")]),s._v(\" 配置虚拟库和虚拟表\")]),s._v(\" \"),t(\"p\",[s._v(\"修改 schema.xml 文件\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"dataNode 标签可以设置使用的真实逻辑库\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"dn1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"dn2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"dn3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"dn4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"pxc2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn3\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dataNode\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataHost\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"rep2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"database\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"schema 标签可以设置虚拟逻辑库，table 标签可以设置虚拟关系表\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"schema\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"neti\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"checkSQLschema\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"false\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"sqlMaxLimit\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"table\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"teacher\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataNode\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"dn1,dn2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"type\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"global\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"schema\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"schema\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t1\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"checkSQLschema\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"false\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"sqlMaxLimit\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"table\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"teacher\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataNode\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn1,tdn2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"type\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"global\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"schema\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"schema\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"t2\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"checkSQLschema\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"false\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"sqlMaxLimit\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"100\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"table\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"teacher\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataNode\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn3,tdn4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"type\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"global\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"table\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"student\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"dataNode\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"tdn3,tdn4\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"type\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mod-long\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"/>\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"schema\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\")])]),t(\"p\",[s._v(\"修改 server.xml 文件\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"user\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"admin\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"defaultAccount\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"true\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"property\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"password\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"123456\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"property\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"property\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"schemas\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"neti,t1,t2\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"property\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v('\\x3c!--<property name=\"defaultSchema\">neti</property>--\\x3e')]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"\\x3c!--No MyCAT Database selected 错误前会尝试使用该schema作为schema，不设置则为null,报错 --\\x3e\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"修改-mod-long-算法\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#修改-mod-long-算法\"}},[s._v(\"#\")]),s._v(\" 修改 mod-long 算法\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"MyCat 默认的 mod-long 是按照三个分片切片数据，所以我们要求改这个默认值\")])]),s._v(\" \"),t(\"p\",[s._v(\"修改 rule.xml 文件中的 mod-long 分片数量\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"function\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"mod-long\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"class\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"io.mycat.route.function.PartitionByMod\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"\\x3c!-- how many data nodes --\\x3e\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"property\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[s._v(\"name\")]),t(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')]),s._v(\"count\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v('\"')])]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"2\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"property\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"function\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"mycat-日志文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#mycat-日志文件\"}},[s._v(\"#\")]),s._v(\" MyCat 日志文件\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"MyCat 日志文件主要有 wrapper.log 和 mycat.log,存放在 logs 目录\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it mycat1 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /root/server/mycat\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"启动-mycat\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启动-mycat\"}},[s._v(\"#\")]),s._v(\" 启动 MyCat\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it mycat1 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" /root/server/mycat/bin\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#为 MyCat/bin 目录中所有 sh 命令设置最高权限\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" -R \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"777\")]),s._v(\" ./*.sh\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#启动 MyCat程序\")]),s._v(\"\\n./mycat start\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"haproxy\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#haproxy\"}},[s._v(\"#\")]),s._v(\" Haproxy\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"安装-haproxy-镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#安装-haproxy-镜像\"}},[s._v(\"#\")]),s._v(\" 安装 Haproxy 镜像\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker pull haproxy\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建-haproxy-配置文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建-haproxy-配置文件\"}},[s._v(\"#\")]),s._v(\" 创建 Haproxy 配置文件\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"参考-https-zhang-ge-5125-html\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考-https-zhang-ge-5125-html\"}},[s._v(\"#\")]),s._v(\" 参考: \"),t(\"a\",{attrs:{href:\"https://zhang.ge/5125.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://zhang.ge/5125.html\"),t(\"OutboundLink\")],1)]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 启动容器时使用目录映射技术使容器读取该配置文件\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /home/soft/haproxy/haproxy.cfg\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"global\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#工作目录\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chroot\")]),s._v(\" /usr/local/etc/haproxy\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#日志文件，使用rsyslog服务中local5日志设备（/var/log/local5），等级info\")]),s._v(\"\\n\\tlog \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),s._v(\".0.1 local5 info\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#守护进程运行\")]),s._v(\"\\n\\tdaemon\\n\\ndefaults\\n\\tlog\\tglobal\\n\\tmode\\thttp\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#日志格式\")]),s._v(\"\\n\\toption\\thttplog\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#日志中不记录负载均衡的心跳检测记录\")]),s._v(\"\\n\\toption\\tdontlognull\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#连接超时（毫秒）\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"timeout\")]),s._v(\" connect \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5000\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#客户端超时（毫秒）\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"timeout\")]),s._v(\" client  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50000\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#服务器超时（毫秒）\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"timeout\")]),s._v(\" server  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50000\")]),s._v(\"\\n\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#监控界面\")]),s._v(\"\\nlisten  admin_stats\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#监控界面的访问的IP和端口\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"bind\")]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0.0\")]),s._v(\".0.0:8888\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#访问协议\")]),s._v(\"\\n    mode        http\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#URI相对地址\")]),s._v(\"\\n    stats uri   /dbs\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#统计报告格式\")]),s._v(\"\\n    stats realm     Global\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\" statistics\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#登陆帐户信息\")]),s._v(\"\\n    stats auth  admin:123456\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#数据库负载均衡\")]),s._v(\"\\nlisten  proxy-mysql\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#访问的IP和端口\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"bind\")]),s._v(\"  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0.0\")]),s._v(\".0.0:3306\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#网络协议\")]),s._v(\"\\n\\tmode  tcp\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#负载均衡算法（轮询算法）\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#轮询算法：roundrobin\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#权重算法：static-rr\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#最少连接算法：leastconn\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#请求源IP算法：source\")]),s._v(\"\\n    balance  roundrobin\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#日志格式\")]),s._v(\"\\n    option  tcplog\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#在MySQL中创建一个没有权限的haproxy用户，密码为空。Haproxy使用这个账户对MySQL数据库心跳检测\")]),s._v(\"\\n    option  mysql-check user haproxy\\n    server  MySQL_1 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.2:3306 check weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" maxconn \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2000\")]),s._v(\"\\n    server  MySQL_2 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.3:3306 check weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" maxconn \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2000\")]),s._v(\"\\n\\tserver  MySQL_3 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.4:3306 check weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" maxconn \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2000\")]),s._v(\"\\n\\tserver  MySQL_4 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.5:3306 check weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" maxconn \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2000\")]),s._v(\"\\n\\tserver  MySQL_5 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.6:3306 check weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" maxconn \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2000\")]),s._v(\"\\n\\t\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#使用keepalive检测死链\")]),s._v(\"\\n    option  tcpka\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"52\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"53\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"54\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"55\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"56\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"57\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"在数据库集群中创建空密码、无权限用户-haproxy，来供-haproxy-对-mysql-数据库进行心跳检测\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#在数据库集群中创建空密码、无权限用户-haproxy，来供-haproxy-对-mysql-数据库进行心跳检测\"}},[s._v(\"#\")]),s._v(\" 在数据库集群中创建空密码、无权限用户 haproxy，来供 Haproxy 对 MySQL 数据库进行心跳检测\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"create user \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'haproxy'\")]),s._v(\"@\"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'%'\")]),s._v(\" identified by \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"''\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"创建两个-haproxy-容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建两个-haproxy-容器\"}},[s._v(\"#\")]),s._v(\" 创建两个 Haproxy 容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建第1个Haproxy负载均衡服务器\")]),s._v(\"\\ndocker run -it -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4001\")]),s._v(\":8888 -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4002\")]),s._v(\":3306 -v /home/soft/haproxy:/usr/local/etc/haproxy --name h1 --privileged --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"net1 --ip \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.7 haproxy\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#进入h1容器，启动Haproxy\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it h1 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\nhaproxy -f /usr/local/etc/haproxy/haproxy.cfg\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#创建第2个Haproxy负载均衡服务器\")]),s._v(\"\\ndocker run -it -d --restart\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4003\")]),s._v(\":8888 -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4004\")]),s._v(\":3306 -v /home/soft/haproxy:/usr/local/etc/haproxy --name h2 --privileged --net\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"net1 --ip \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.8 haproxy\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#进入h2容器，启动Haproxy\")]),s._v(\"\\ndocker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it h2 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\nhaproxy -f /usr/local/etc/haproxy/haproxy.cfg\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"在浏览器中打开-haproxy-监控界面，端口-4001，在配置文件中定义有用户名-admin，密码-123456。我这边访问的是http-192-168-123-130-4001-dbs，并且要使用用户名密码进行登录\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#在浏览器中打开-haproxy-监控界面，端口-4001，在配置文件中定义有用户名-admin，密码-123456。我这边访问的是http-192-168-123-130-4001-dbs，并且要使用用户名密码进行登录\"}},[s._v(\"#\")]),s._v(\" 在浏览器中打开 Haproxy 监控界面，端口 4001，在配置文件中定义有用户名 admin，密码 123456。我这边访问的是http://192.168.123.130:4001/dbs，并且要使用用户名密码进行登录\")]),s._v(\" \"),t(\"h2\",{attrs:{id:\"keepalived\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#keepalived\"}},[s._v(\"#\")]),s._v(\" Keepalived\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker 中创建两个 Haproxy，并通过 Keepalived 抢占 Docker 内的虚拟 IP\")]),s._v(\" \"),t(\"p\",[s._v(\"Docker 内的虚拟 IP 不能被外网，所以需要借助宿主机 Keepalived 映射成外网可以访问地虚拟 IP\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"进入-h1-容器-安装-keepalived\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#进入-h1-容器-安装-keepalived\"}},[s._v(\"#\")]),s._v(\" 进入 h1 容器,安装 Keepalived\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it h1 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" update\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" keepalived\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"编辑-keepalived-配置文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#编辑-keepalived-配置文件\"}},[s._v(\"#\")]),s._v(\" 编辑 Keepalived 配置文件\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/keepalived/keepalived.conf\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"vrrp_instance  VI_1 \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    state  MASTER \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Keepalived的身份（MASTER主服务要抢占IP，BACKUP备服务器不会抢占IP）。\")]),s._v(\"\\n    interface  eth0 \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# docker网卡设备，虚拟IP所在\")]),s._v(\"\\n    virtual_router_id  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 虚拟路由标识，MASTER和BACKUP的虚拟路由标识必须一致。从0～255\")]),s._v(\"\\n    priority  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"100\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# MASTER权重要高于BACKUP数字越大优先级越高\")]),s._v(\"\\n    advert_int  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# MASTER和BACKUP节点同步检查的时间间隔，单位为秒，主备之间必须一致\")]),s._v(\"\\n    authentication \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 主从服务器验证方式。主备必须使用相同的密码才能正常通信\")]),s._v(\"\\n        auth_type  PASS\\n        auth_pass  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    virtual_ipaddress \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 虚拟IP。可以设置多个虚拟IP地址，每行一个\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"启动-keepalived\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启动-keepalived\"}},[s._v(\"#\")]),s._v(\" 启动 Keepalived\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" keepalived start\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"宿主机执行-ping-命令\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#宿主机执行-ping-命令\"}},[s._v(\"#\")]),s._v(\" 宿主机执行 ping 命令\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ping\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"进入-h2-容器-安装-keepalived\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#进入-h2-容器-安装-keepalived\"}},[s._v(\"#\")]),s._v(\" 进入 h2 容器,安装 Keepalived\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it h2 \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" update\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"apt-get\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" keepalived\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"编辑-keepalived-配置文件-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#编辑-keepalived-配置文件-2\"}},[s._v(\"#\")]),s._v(\" 编辑 Keepalived 配置文件\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/keepalived/keepalived.conf\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\" vrrp_instance  VI_1 \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    state  MASTER\\n    interface  eth0\\n    virtual_router_id  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51\")]),s._v(\"\\n    priority  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"100\")]),s._v(\"\\n    advert_int  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n    authentication \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        auth_type  PASS\\n        auth_pass  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    virtual_ipaddress \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"启动-keepalived-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启动-keepalived-2\"}},[s._v(\"#\")]),s._v(\" 启动 Keepalived\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" keepalived start\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"宿主机执行-ping-命令-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#宿主机执行-ping-命令-2\"}},[s._v(\"#\")]),s._v(\" 宿主机执行 ping 命令\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ping\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"h4\",{attrs:{id:\"实现外网访问虚拟-ip\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#实现外网访问虚拟-ip\"}},[s._v(\"#\")]),s._v(\" 实现外网访问虚拟 IP\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"宿主机执行安装 Keepalived\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"yum \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" keepalived\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"编辑 Keepalived 配置文件\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vi\")]),s._v(\" /etc/keepalived/keepalived.conf\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\" vrrp_instance VI_1 \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    state MASTER\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#这里是宿主机的网卡，可以通过ip a查看当前自己电脑上用的网卡名是哪个\")]),s._v(\"\\n    interface ens33\\n    virtual_router_id \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51\")]),s._v(\"\\n    priority \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"100\")]),s._v(\"\\n    advert_int \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n    authentication \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        auth_type PASS\\n        auth_pass \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1111\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    virtual_ipaddress \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#这里是指定的一个宿主机上的虚拟ip，一定要和宿主机网卡在同一个网段，\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".123.150\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n​\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#接受监听数据来源的端口，网页入口使用\")]),s._v(\"\\nvirtual_server \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".123.150 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8888\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    delay_loop \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),s._v(\"\\n    lb_algo rr\\n    lb_kind NAT\\n    persistence_timeout \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"\\n    protocol TCP\\n​    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#把接受到的数据转发给docker服务的网段及端口，由于是发给docker服务，所以和docker服务数据要一致\")]),s._v(\"\\n    real_server \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8888\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n​\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#接受数据库数据端口，宿主机数据库端口是3306，所以这里也要和宿主机数据接受端口一致\")]),s._v(\"\\nvirtual_server \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".123.150 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    delay_loop \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),s._v(\"\\n    lb_algo rr\\n    lb_kind NAT\\n    persistence_timeout \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"\\n    protocol TCP\\n​    \"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#同理转发数据库给服务的端口和ip要求和docker服务中的数据一致\")]),s._v(\"\\n    real_server \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"172.18\")]),s._v(\".0.201 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        weight \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"启动 Keepalived\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" keepalived start\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}